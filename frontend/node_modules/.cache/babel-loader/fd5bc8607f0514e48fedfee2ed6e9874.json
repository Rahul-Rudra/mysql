{"ast":null,"code":"import _toConsumableArray from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import NavBar from\"./NavBar\";import Pagination from\"./Pagination\";import{Paginate}from\"./util/Paginate\";import axios from\"axios\";var Message=/*#__PURE__*/function(_Component){_inherits(Message,_Component);var _super=_createSuper(Message);function Message(){var _this;_classCallCheck(this,Message);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={message:[],issue:[],pageSize:10,count:0,currentPage:1};_this.IssueBook=function(book_id,u_id,user_id){// const user_id = localStorage.getItem(\"id\");\n//console.log(user_id);\naxios.post(\"/api/book/\".concat(book_id,\"/issue/\").concat(user_id)).then(function(res){//const users = this.state.user.filter((c) => c._id !== book_id);\nconsole.log(res.data);//this.setState((this.state.pos = 1));\n// this.state.bool = false;\n_this.setState({issue:res.data});_this.allowBook(u_id);return _this.props.history.push(\"/dashboard\");//res.data.st === 0 ? toast(\"Stock is zero\") : \"\";\n}).catch(function(error){//const msg = \"you can not isssue more than 5 books\";\nconsole.log(error);//toast.error(msg);\n});};_this.allowBook=function(id){axios.put(\"/api/messages/\".concat(id)).then(function(res){//const message = this.state.message.filter((c) => c._id !== id);\n_this.setState({message:res.data});});};_this.RejectBook=function(id){axios.put(\"/api/messages/reject/\".concat(id)).then(function(res){//const message = this.state.message.filter((c) => c._id !== id);\n_this.setState({message:res.data});return _this.props.history.push(\"/dashboard\");});};_this.control=function(id){_this.setState({count:_this.state.count+1});// return this.state.count;\n};_this.handlePageChange=function(page){_this.setState({currentPage:page});};return _this;}_createClass(Message,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axios.get(\"/api/messages\").then(function(response){//this.state.movie = response.data;\n_this2.setState({message:_toConsumableArray(response.data)});console.log(response.data);}).catch(function(error){console.log(error);});}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,pageSize=_this$state.pageSize,currentPage=_this$state.currentPage,allmessage=_this$state.message;var message=Paginate(allmessage,currentPage,pageSize);return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered table-hover table-lg  p-2 m-2\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"BookId\"),/*#__PURE__*/React.createElement(\"th\",null,\"UserId\"),/*#__PURE__*/React.createElement(\"th\",null,\"Message\"),/*#__PURE__*/React.createElement(\"th\",null,\"Allow\"),/*#__PURE__*/React.createElement(\"th\",null,\"Cancel\"))),/*#__PURE__*/React.createElement(\"tbody\",null,message.map(function(u,i){// const name=localStorage.getItem(\"name\");\nreturn/*#__PURE__*/React.createElement(\"tr\",{key:i},/*#__PURE__*/React.createElement(\"td\",null,u.book_id),/*#__PURE__*/React.createElement(\"td\",null,u.user_id),/*#__PURE__*/React.createElement(\"td\",null,u.text),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary float-right\",onClick:function onClick(){_this3.IssueBook(u.book_id,u.message_id,u.user_id);}},\"Allow\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-secondary float-right\",onClick:function onClick(){_this3.RejectBook(u._id);}},\"Reject\")));}))),/*#__PURE__*/React.createElement(Pagination,{itemsCount:this.state.message.length,pageSize:this.state.pageSize,currentPage:this.state.currentPage,onPageChange:this.handlePageChange}));}}]);return Message;}(Component);export default Message;","map":{"version":3,"sources":["/home/rudra/Documents/Library-sql/frontend/src/components/Message.jsx"],"names":["React","Component","Fragment","NavBar","Pagination","Paginate","axios","Message","state","message","issue","pageSize","count","currentPage","IssueBook","book_id","u_id","user_id","post","then","res","console","log","data","setState","allowBook","props","history","push","catch","error","id","put","RejectBook","control","handlePageChange","page","get","response","allmessage","map","u","i","text","message_id","_id","length"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport NavBar from \"./NavBar\";\nimport Pagination from \"./Pagination\";\nimport { Paginate } from \"./util/Paginate\";\n\nimport axios from \"axios\";\nclass Message extends Component {\n  state = {\n    message: [],\n    issue: [],\n    pageSize: 10,\n    count: 0,\n    currentPage: 1,\n  };\n\n  componentDidMount() {\n    axios\n      .get(\"/api/messages\")\n      .then((response) => {\n        //this.state.movie = response.data;\n\n        this.setState({ message: [...response.data] });\n        console.log(response.data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  }\n\n  IssueBook = (book_id, u_id, user_id) => {\n    // const user_id = localStorage.getItem(\"id\");\n\n    //console.log(user_id);\n    axios\n      .post(`/api/book/${book_id}/issue/${user_id}`)\n      .then((res) => {\n        //const users = this.state.user.filter((c) => c._id !== book_id);\n        console.log(res.data);\n\n        //this.setState((this.state.pos = 1));\n        // this.state.bool = false;\n        this.setState({ issue: res.data });\n        this.allowBook(u_id);\n        return this.props.history.push(\"/dashboard\");\n        //res.data.st === 0 ? toast(\"Stock is zero\") : \"\";\n      })\n      .catch((error) => {\n        //const msg = \"you can not isssue more than 5 books\";\n        console.log(error);\n        //toast.error(msg);\n      });\n  };\n\n  allowBook = (id) => {\n    axios.put(`/api/messages/${id}`).then((res) => {\n      //const message = this.state.message.filter((c) => c._id !== id);\n      this.setState({ message: res.data });\n    });\n  };\n\n  RejectBook = (id) => {\n    axios.put(`/api/messages/reject/${id}`).then((res) => {\n      //const message = this.state.message.filter((c) => c._id !== id);\n      this.setState({ message: res.data });\n      return this.props.history.push(\"/dashboard\");\n    });\n  };\n  control = (id) => {\n    this.setState({ count: this.state.count + 1 });\n    // return this.state.count;\n  };\n\n  handlePageChange = (page) => {\n    this.setState({ currentPage: page });\n  };\n\n  render() {\n    const { pageSize, currentPage, message: allmessage } = this.state;\n    const message = Paginate(allmessage, currentPage, pageSize);\n    return (\n      <Fragment>\n        <NavBar />\n        <table className=\"table table-bordered table-hover table-lg  p-2 m-2\">\n          <thead>\n            <tr>\n              <th scope=\"col\">BookId</th>\n              <th>UserId</th>\n             \n              <th>Message</th>\n              <th>Allow</th>\n              <th>Cancel</th>\n            </tr>\n          </thead>\n          <tbody>\n            {message.map((u, i) => {\n             // const name=localStorage.getItem(\"name\");\n              return (\n                <tr key={i}>\n                  <td>{u.book_id}</td>\n                  <td>{u.user_id}</td>\n\n              \n                  <td>{u.text}</td>\n\n                  <td>\n                    <button\n                      type=\"button\"\n                      className=\"btn btn-primary float-right\"\n                      onClick={() => {\n                        this.IssueBook(u.book_id, u.message_id, u.user_id);\n                      }}\n                    >\n                      Allow\n                    </button>\n                  </td>\n\n                  <td>\n                    <button\n                      type=\"button\"\n                      className=\"btn btn-secondary float-right\"\n                      onClick={() => {\n                        this.RejectBook(u._id);\n                      }}\n                    >\n                      Reject\n                    </button>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n\n        <Pagination\n          itemsCount={this.state.message.length}\n          pageSize={this.state.pageSize}\n          currentPage={this.state.currentPage}\n          onPageChange={this.handlePageChange}\n        />\n      </Fragment>\n    );\n  }\n}\n\nexport default Message;\n"]},"metadata":{},"sourceType":"module"}