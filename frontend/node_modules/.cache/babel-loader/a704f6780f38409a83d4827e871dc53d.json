{"ast":null,"code":"import _toConsumableArray from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/rudra/Documents/Library-sql/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import NavBar from\"./NavBar\";import Pagination from\"./Pagination\";import{Paginate}from\"./util/Paginate\";import axios from\"axios\";var Message=/*#__PURE__*/function(_Component){_inherits(Message,_Component);var _super=_createSuper(Message);function Message(){var _this;_classCallCheck(this,Message);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={issue:[],message1:[],pageSize:10,count:0,currentPage:1};_this.IssueBook=function(book_id,u_id){var user_id=localStorage.getItem(\"id\");//console.log(user_id);\naxios.post(\"/api/book/\".concat(book_id,\"/issue/\").concat(user_id)).then(function(res){//const users = this.state.user.filter((c) => c._id !== book_id);\nconsole.log(res.data);//this.setState((this.state.pos = 1));\n// this.state.bool = false;\n_this.setState({issue:res.data});// this.allowBook(u_id);\nreturn _this.props.history.push(\"/dashboard\");//res.data.st === 0 ? toast(\"Stock is zero\") : \"\";\n}).catch(function(error){//const msg = \"you can not isssue more than 5 books\";\nconsole.log(error);//toast.error(msg);\n});};_this.allowBook=function(id){axios.put(\"/api/messages/allowed/\".concat(id)).then(function(res){//const message = this.state.message.filter((c) => c._id !== id);\n_this.setState({message:res.data});});};_this.control=function(id){_this.setState({count:_this.state.count+1});// return this.state.count;\n};_this.handlePageChange=function(page){_this.setState({currentPage:page});};return _this;}_createClass(Message,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axios.get(\"/api/messages/allowed\").then(function(response){//this.state.movie = response.data;\n_this2.setState({message1:_toConsumableArray(response.data)});console.log(response.data);}).catch(function(error){console.log(error);});}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,pageSize=_this$state.pageSize,currentPage=_this$state.currentPage,allmessage=_this$state.message1;var message1=Paginate(allmessage,currentPage,pageSize);return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered table-hover table-lg  p-2 m-2\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"BookId\"),/*#__PURE__*/React.createElement(\"th\",null,\"UserId\"),/*#__PURE__*/React.createElement(\"th\",null,\"Message\"),/*#__PURE__*/React.createElement(\"th\",null,\"Allow\"),/*#__PURE__*/React.createElement(\"th\",null,\"Cancel\"))),/*#__PURE__*/React.createElement(\"tbody\",null,message1.map(function(u,i){return/*#__PURE__*/React.createElement(\"tr\",{key:i},/*#__PURE__*/React.createElement(\"td\",null,u.book_id),/*#__PURE__*/React.createElement(\"td\",null,u.user_id),/*#__PURE__*/React.createElement(\"td\",null,u.text),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",disabled:\"true\",className:\"btn btn-primary float-right disabled\",onClick:function onClick(){_this3.IssueBook(u.book_info.id,u._id);}},\"Allow\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",disabled:\"true\",className:\"btn btn-secondary float-right disabled\",onClick:function onClick(){_this3.CancelBook(u.message_id);}},\"Cancel\")));}))),/*#__PURE__*/React.createElement(Pagination,{itemsCount:this.state.message1.length,pageSize:this.state.pageSize,currentPage:this.state.currentPage,onPageChange:this.handlePageChange}));}}]);return Message;}(Component);export default Message;","map":{"version":3,"sources":["/home/rudra/Documents/Library-sql/frontend/src/components/AllowedMessage.jsx"],"names":["React","Component","Fragment","NavBar","Pagination","Paginate","axios","Message","state","issue","message1","pageSize","count","currentPage","IssueBook","book_id","u_id","user_id","localStorage","getItem","post","then","res","console","log","data","setState","props","history","push","catch","error","allowBook","id","put","message","control","handlePageChange","page","get","response","allmessage","map","u","i","text","book_info","_id","CancelBook","message_id","length"],"mappings":"6xBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,OAASC,QAAT,KAAyB,iBAAzB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,GACMC,CAAAA,O,+TACJC,K,CAAQ,CACNC,KAAK,CAAE,EADD,CAENC,QAAQ,CAAE,EAFJ,CAGNC,QAAQ,CAAE,EAHJ,CAINC,KAAK,CAAE,CAJD,CAKNC,WAAW,CAAE,CALP,C,OAsBRC,S,CAAY,SAACC,OAAD,CAAUC,IAAV,CAAmB,CAC7B,GAAMC,CAAAA,OAAO,CAAGC,YAAY,CAACC,OAAb,CAAqB,IAArB,CAAhB,CAEA;AACAb,KAAK,CACFc,IADH,qBACqBL,OADrB,mBACsCE,OADtC,GAEGI,IAFH,CAEQ,SAACC,GAAD,CAAS,CACb;AACAC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EAEA;AACA;AACA,MAAKC,QAAL,CAAc,CAAEjB,KAAK,CAAEa,GAAG,CAACG,IAAb,CAAd,EACA;AACA,MAAO,OAAKE,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,YAAxB,CAAP,CACA;AACD,CAZH,EAaGC,KAbH,CAaS,SAACC,KAAD,CAAW,CAChB;AACAR,OAAO,CAACC,GAAR,CAAYO,KAAZ,EACA;AACD,CAjBH,EAkBD,C,OAEDC,S,CAAY,SAACC,EAAD,CAAQ,CAClB3B,KAAK,CAAC4B,GAAN,iCAAmCD,EAAnC,GAAyCZ,IAAzC,CAA8C,SAACC,GAAD,CAAS,CACrD;AACA,MAAKI,QAAL,CAAc,CAAES,OAAO,CAAEb,GAAG,CAACG,IAAf,CAAd,EACD,CAHD,EAID,C,OAEDW,O,CAAU,SAACH,EAAD,CAAQ,CAChB,MAAKP,QAAL,CAAc,CAAEd,KAAK,CAAE,MAAKJ,KAAL,CAAWI,KAAX,CAAmB,CAA5B,CAAd,EACA;AACD,C,OAEDyB,gB,CAAmB,SAACC,IAAD,CAAU,CAC3B,MAAKZ,QAAL,CAAc,CAAEb,WAAW,CAAEyB,IAAf,CAAd,EACD,C,gGApDmB,iBAClBhC,KAAK,CACFiC,GADH,CACO,uBADP,EAEGlB,IAFH,CAEQ,SAACmB,QAAD,CAAc,CAClB;AAEA,MAAI,CAACd,QAAL,CAAc,CAAEhB,QAAQ,oBAAM8B,QAAQ,CAACf,IAAf,CAAV,CAAd,EACAF,OAAO,CAACC,GAAR,CAAYgB,QAAQ,CAACf,IAArB,EACD,CAPH,EAQGK,KARH,CAQS,SAACC,KAAD,CAAW,CAChBR,OAAO,CAACC,GAAR,CAAYO,KAAZ,EACD,CAVH,EAWD,C,uCA0CQ,iCACiD,KAAKvB,KADtD,CACCG,QADD,aACCA,QADD,CACWE,WADX,aACWA,WADX,CACkC4B,UADlC,aACwB/B,QADxB,CAEP,GAAMA,CAAAA,QAAQ,CAAGL,QAAQ,CAACoC,UAAD,CAAa5B,WAAb,CAA0BF,QAA1B,CAAzB,CACA,mBACE,oBAAC,QAAD,mBACE,oBAAC,MAAD,MADF,cAEE,6BAAO,SAAS,CAAC,oDAAjB,eACE,8CACE,2CACE,0BAAI,KAAK,CAAC,KAAV,WADF,cAEE,uCAFF,cAIE,wCAJF,cAKE,sCALF,cAME,uCANF,CADF,CADF,cAWE,iCACGD,QAAQ,CAACgC,GAAT,CAAa,SAACC,CAAD,CAAIC,CAAJ,CAAU,CACtB,mBACE,0BAAI,GAAG,CAAEA,CAAT,eACE,8BAAKD,CAAC,CAAC5B,OAAP,CADF,cAEE,8BAAK4B,CAAC,CAAC1B,OAAP,CAFF,cAKE,8BAAK0B,CAAC,CAACE,IAAP,CALF,cAOE,2CACE,8BACE,IAAI,CAAC,QADP,CAEE,QAAQ,CAAC,MAFX,CAGE,SAAS,CAAC,sCAHZ,CAIE,OAAO,CAAE,kBAAM,CACb,MAAI,CAAC/B,SAAL,CAAe6B,CAAC,CAACG,SAAF,CAAYb,EAA3B,CAA+BU,CAAC,CAACI,GAAjC,EACD,CANH,UADF,CAPF,cAoBE,2CACE,8BACE,IAAI,CAAC,QADP,CAEE,QAAQ,CAAC,MAFX,CAGE,SAAS,CAAC,wCAHZ,CAIE,OAAO,CAAE,kBAAM,CACb,MAAI,CAACC,UAAL,CAAgBL,CAAC,CAACM,UAAlB,EACD,CANH,WADF,CApBF,CADF,CAmCD,CApCA,CADH,CAXF,CAFF,cAsDE,oBAAC,UAAD,EACE,UAAU,CAAE,KAAKzC,KAAL,CAAWE,QAAX,CAAoBwC,MADlC,CAEE,QAAQ,CAAE,KAAK1C,KAAL,CAAWG,QAFvB,CAGE,WAAW,CAAE,KAAKH,KAAL,CAAWK,WAH1B,CAIE,YAAY,CAAE,KAAKwB,gBAJrB,EAtDF,CADF,CA+DD,C,qBAjImBpC,S,EAoItB,cAAeM,CAAAA,OAAf","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport NavBar from \"./NavBar\";\nimport Pagination from \"./Pagination\";\nimport { Paginate } from \"./util/Paginate\";\n\nimport axios from \"axios\";\nclass Message extends Component {\n  state = {\n    issue: [],\n    message1: [],\n    pageSize: 10,\n    count: 0,\n    currentPage: 1,\n  };\n\n  componentDidMount() {\n    axios\n      .get(\"/api/messages/allowed\")\n      .then((response) => {\n        //this.state.movie = response.data;\n\n        this.setState({ message1: [...response.data] });\n        console.log(response.data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  }\n\n  IssueBook = (book_id, u_id) => {\n    const user_id = localStorage.getItem(\"id\");\n\n    //console.log(user_id);\n    axios\n      .post(`/api/book/${book_id}/issue/${user_id}`)\n      .then((res) => {\n        //const users = this.state.user.filter((c) => c._id !== book_id);\n        console.log(res.data);\n\n        //this.setState((this.state.pos = 1));\n        // this.state.bool = false;\n        this.setState({ issue: res.data });\n        // this.allowBook(u_id);\n        return this.props.history.push(\"/dashboard\");\n        //res.data.st === 0 ? toast(\"Stock is zero\") : \"\";\n      })\n      .catch((error) => {\n        //const msg = \"you can not isssue more than 5 books\";\n        console.log(error);\n        //toast.error(msg);\n      });\n  };\n\n  allowBook = (id) => {\n    axios.put(`/api/messages/allowed/${id}`).then((res) => {\n      //const message = this.state.message.filter((c) => c._id !== id);\n      this.setState({ message: res.data });\n    });\n  };\n\n  control = (id) => {\n    this.setState({ count: this.state.count + 1 });\n    // return this.state.count;\n  };\n\n  handlePageChange = (page) => {\n    this.setState({ currentPage: page });\n  };\n\n  render() {\n    const { pageSize, currentPage, message1: allmessage } = this.state;\n    const message1 = Paginate(allmessage, currentPage, pageSize);\n    return (\n      <Fragment>\n        <NavBar />\n        <table className=\"table table-bordered table-hover table-lg  p-2 m-2\">\n          <thead>\n            <tr>\n              <th scope=\"col\">BookId</th>\n              <th>UserId</th>\n              \n              <th>Message</th>\n              <th>Allow</th>\n              <th>Cancel</th>\n            </tr>\n          </thead>\n          <tbody>\n            {message1.map((u, i) => {\n              return (\n                <tr key={i}>\n                  <td>{u.book_id}</td>\n                  <td>{u.user_id}</td>\n\n                 \n                  <td>{u.text}</td>\n\n                  <td>\n                    <button\n                      type=\"button\"\n                      disabled=\"true\"\n                      className=\"btn btn-primary float-right disabled\"\n                      onClick={() => {\n                        this.IssueBook(u.book_info.id, u._id);\n                      }}\n                    >\n                      Allow\n                    </button>\n                  </td>\n\n                  <td>\n                    <button\n                      type=\"button\"\n                      disabled=\"true\"\n                      className=\"btn btn-secondary float-right disabled\"\n                      onClick={() => {\n                        this.CancelBook(u.message_id);\n                      }}\n                    >\n                      Cancel\n                    </button>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n\n        <Pagination\n          itemsCount={this.state.message1.length}\n          pageSize={this.state.pageSize}\n          currentPage={this.state.currentPage}\n          onPageChange={this.handlePageChange}\n        />\n      </Fragment>\n    );\n  }\n}\n\nexport default Message;\n"]},"metadata":{},"sourceType":"module"}